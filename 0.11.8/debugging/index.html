
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Debugging</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/banner.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Evaluating and Testing" href="../evaluation/" />
    <link rel="prev" title="Training and Policies" href="../policies/" />

 <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MMHSZCS');</script>
    <!-- End Google Tag Manager -->
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
  <meta itemprop="image" content="https://rasa.com/assets/img/facebook-og.png">
  <meta property="og:title" content="Debugging" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rasa.com/assets/img/facebook-og.png" />
  <meta property="og:url" content="https://rasa.com/docs/core/debugging" />
  
    <meta name="description" content="Tips for Debugging a Rasa bot" />
    <meta itemprop="description" content="Tips for Debugging a Rasa bot">
    <meta name="twitter:description" content="Tips for Debugging a Rasa bot" />
    <meta property="og:description" content="Tips for Debugging a Rasa bot" />
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@Rasa_HQ">
  <meta name="twitter:title" content="Debugging">
  <meta name="twitter:creator" content="@Rasa_HQ">
  <meta name="twitter:image" content="https://rasa.com/assets/img/facebook-og.png">

  <link rel="stylesheet" href="../_static/xq-light.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fontawesome/css/fontawesome-all.css" type="text/css" />
  <!--<script defer type="text/javascript" src="../_static/config.js"></script>
  <script defer type="text/javascript" src="../_static/klaro.js"></script>-->
  <script type="text/javascript" src="https://storage.googleapis.com/docs-theme/clipboard.min.js"></script>
  
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


  </head><body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MMHSZCS" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="nav-top">
  <div class="nav-container">
    <a href="/docs" class="brand-link">
        <h1 class="brand">
            <img src="../_static/rasa_logo.svg" width="80px" height="40px" title="Rasa logo" alt="Rasa logo">
        </h1>
        <span class="logo extension">docs</span>
    </a>

    <ul class="nav">
      <input type="text" class="search" placeholder="Search">
      
        
          <li><a href=/docs/getting-started/>Getting Started</a></li>
        
      
        
          <li><a href=/docs/nlu/>NLU</a></li>
        
      
        
          <li class="active"><a href=/docs/core/>Core</a></li>
        
      
        
          <li><a href=/docs/platform/>Platform</a></li>
        
      

      <li>
        <a href="https://forum.rasa.com" target="_blank"><button class="button btn-ghost btn-small">Join Community</button></a>
      </li>

    </ul>
  </div>
</div>

  <div class="sidebar-extended"></div>
  <div class="document">

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture/">High-Level Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connectors/">Chat &amp; Voice platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../customactions/">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slots/">Using Slots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slotfilling/">Slot Filling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../responses/">Bot Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive_learning/">Interactive Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fallbacks/">Fallback Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../policies/">Training and Policies</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation/">Evaluating and Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../domains/">Domain Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stories/">Story Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/slots_api/">Slot Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/agent/">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/events/">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tracker/">Dialogue State Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/interpreter/">Interpreters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/policy/">Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/featurizer/">Featurization</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../migrations/">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../brokers/">Event Brokers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/">Using Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/">Getting Support</a></li>
</ul>

<div class="versions">
    <p class="caption">Versions</p>
    <div class="versions-content">
      <div>
        <span class="current-version">
          viewing: 0.11.8
        </span>
      </div>
      <div class="other-versions">
          <p>tags</p>
          <div class="dropdown-content">
              <a href="../../0.11.12/debugging/">0.11.12</a>
              <a href="../../0.11.11/debugging/">0.11.11</a>
              <a href="../../0.11.10/debugging/">0.11.10</a>
              <a href="../../0.11.9/debugging/">0.11.9</a>
              <a href="../../0.11.8/debugging/">0.11.8</a>
              <a href="../../0.11.7/debugging/">0.11.7</a>
              <a href="../../0.11.6/debugging/">0.11.6</a>
              <a href="../../0.11.5/debugging/">0.11.5</a>
              <a href="../../0.11.4/debugging/">0.11.4</a>
              <a href="../../0.11.3/debugging/">0.11.3</a>
              <a href="../../0.11.2/debugging/">0.11.2</a>
              <a href="../../0.11.1/debugging/">0.11.1</a>
              <a href="../../0.11.0/debugging/">0.11.0</a>
              <a href="../../0.10.4/debugging/">0.10.4</a>
              <a href="../../0.9.8/index/">0.9.8</a>
              <a href="../../0.8.6/index/">0.8.6</a>
              <a href="../../0.7.9/index/">0.7.9</a>
              <a href="../../0.6.9/index/">0.6.9</a>
          </div>
          <p>branches</p>
          <div class="dropdown-content">
              <a href="../../master/debugging/">master</a>
          </div>
      </div>
    </div>
</div>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  


    
    



    <p class="scv-banner"><a href="../../0.11.12/debugging/"><b>Warning:</b> This document is for an old version of Rasa Core. The latest version is 0.11.12.</a></p>
<div class="section" id="debugging">
<span id="id1"></span><h1>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Wherever you are talking to the bot (command line, slack, facebook, etc), you can
clear the tracker and start a new conversation by sending the message <code class="docutils literal notranslate"><span class="pre">/restart</span></code>.</p>
</div>
<p>To debug your bot, run it on the command line with the <code class="docutils literal notranslate"><span class="pre">--debug</span></code> flag.</p>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current --debug
</pre></div>
</div>
<p>This will print lots of information to help you understand what’s going on.
For example:</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span> Bot loaded. Type a message and press enter:
 /greet
 rasa_core.tracker_store - Creating a new tracker <span class="k">for</span> id <span class="s1">&#39;default&#39;</span>.
 rasa_core.processor - Received user message <span class="s1">&#39;/greet&#39;</span> with intent <span class="s1">&#39;{&#39;</span>confidence<span class="s1">&#39;: 1.0, &#39;</span>name<span class="s1">&#39;: &#39;</span>greet<span class="s1">&#39;}&#39;</span> and entities <span class="s1">&#39;[]&#39;</span>
 rasa_core.processor - Logged UserUtterance - tracker now has <span class="m">2</span> events
 rasa_core.processor - Current slot values:

 rasa_core.policies.memoization - Current tracker state <span class="o">[</span>None, <span class="o">{}</span>, <span class="o">{</span><span class="s1">&#39;prev_action_listen&#39;</span>: <span class="m">1</span>.0, <span class="s1">&#39;intent_greet&#39;</span>: <span class="m">1</span>.0<span class="o">}]</span>
 rasa_core.policies.memoization - There is a memorised next action <span class="s1">&#39;2&#39;</span>
 rasa_core.policies.ensemble - Predicted next action using policy_0_MemoizationPolicy
 rasa_core.policies.ensemble - Predicted next action <span class="s1">&#39;utter_greet&#39;</span> with prob <span class="m">1</span>.00.
 Hey! How are you?
</pre></div>
</td></tr></table></div>
<p>Line number <code class="docutils literal notranslate"><span class="pre">4</span></code> tells us the result of NLU parsing the message ‘hello’.
If NLU makes a mistake, your Core model won’t know how to behave. A common
source of errors is that your NLU model didn’t accurately pick the intent,
or made a mistake when extracting entities. If this is the case, you probably
want to go and improve your NLU model.</p>
<p>If any slots are set, those will show up in line <code class="docutils literal notranslate"><span class="pre">6</span></code>.
and in lines <code class="docutils literal notranslate"><span class="pre">9-11</span></code> we can see which policy was used to predict the next action.
If this exact story was already in the training data and the <code class="xref py py-class docutils literal notranslate"><span class="pre">MemoizationPolicy</span></code>
is part of the ensemble, this will be used to predict the next action with probability 1.</p>
<p>If all the slot and NLU information is correct but the wrong action is still predicted,
you should check which policy was used to make the prediction.
If the prediction came from the <code class="xref py py-class docutils literal notranslate"><span class="pre">MemoizationPolicy</span></code>, then there is an error in
your stories. If a probabilistic policy like the <code class="xref py py-class docutils literal notranslate"><span class="pre">KerasPolicy</span></code> was used,
then your model just made a prediction that wasn’t right. In that case
it is a good idea to run the bot with interactive learning switched on so you can
create the relevant stories to add to your training data.</p>
<div class="section" id="visualizing-your-stories">
<span id="story-visualization"></span><h2>Visualizing your Stories<a class="headerlink" href="#visualizing-your-stories" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is helpful to get an overview of the conversational paths that
are described within a story file. To make debugging easier and to ease
discussions about bot flows, you can visualize the content of a story file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>For this to
work, you need to <strong>install graphviz</strong>. These are the instructions to do that
on OSX, for other systems the instructions might be slightly different:</p>
<div class="last highlight-bash notranslate"><div class="highlight"><pre><span></span>brew install graphviz
pip install pygraphviz --install-option<span class="o">=</span><span class="s2">&quot;--include-path=/usr/include/graphviz&quot;</span> <span class="se">\</span>
  --install-option<span class="o">=</span><span class="s2">&quot;--library-path=/usr/lib/graphviz/&quot;</span>
</pre></div>
</div>
</div>
<p>As soon as this is installed you can visualize stories with this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> examples/concertbot/
python -m rasa_core.visualize -d domain.yml -s data/stories.md -o graph.png
</pre></div>
</div>
<p>This will run through the stories of the <code class="docutils literal notranslate"><span class="pre">concertbot</span></code> example in
<code class="docutils literal notranslate"><span class="pre">data/stories.md</span></code> and create a graph stored in the
output image <code class="docutils literal notranslate"><span class="pre">graph.png</span></code>.</p>
<img alt="../_images/concert_stories.png" src="../_images/concert_stories.png" />
<p>We can also run the visualisation directly from code. For this example, we can
create a <code class="docutils literal notranslate"><span class="pre">visualize.py</span></code> in <code class="docutils literal notranslate"><span class="pre">examples/concertbot</span></code> with the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
<span class="kn">from</span> <span class="nn">rasa_core.policies.keras_policy</span> <span class="k">import</span> <span class="n">KerasPolicy</span>
<span class="kn">from</span> <span class="nn">rasa_core.policies.memoization</span> <span class="k">import</span> <span class="n">MemoizationPolicy</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="s2">&quot;domain.yml&quot;</span><span class="p">,</span>
                  <span class="n">policies</span><span class="o">=</span><span class="p">[</span><span class="n">MemoizationPolicy</span><span class="p">(),</span> <span class="n">KerasPolicy</span><span class="p">()])</span>

    <span class="n">agent</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="s2">&quot;data/stories.md&quot;</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="o">=</span><span class="s2">&quot;graph.png&quot;</span><span class="p">,</span> <span class="n">max_history</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Which will create the same image as the previous command.
The graph we show here is still very simple, graphs can quickly get very complex.</p>
<p>You can make your graph a little easier to read by replacing the user messages
with real examples from your nlu data. To do this, use the <code class="docutils literal notranslate"><span class="pre">nlu_data</span></code> flag,
for example <code class="docutils literal notranslate"><span class="pre">--nlu_data</span> <span class="pre">mydata.json</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The story visualization needs to load your domain. If you have
any custom actions written in python make sure they are part of the python
path, and can be loaded by the visualization script using the module path
given for the action in the domain (e.g. <code class="docutils literal notranslate"><span class="pre">actions.ActionSearchVenues</span></code>).</p>
</div>
</div>
<div class="section" id="have-questions-or-feedback">
<h2>Have questions or feedback?<a class="headerlink" href="#have-questions-or-feedback" title="Permalink to this headline">¶</a></h2>
<p>We have a very active support community on <a class="reference external" href="https://forum.rasa.com">Rasa Community Forum</a>
that is happy to help you with your questions. If you have any feedback for us or a specific
suggestion for improving the docs, feel free to share it by creating an issue on Rasa Core
<a class="reference external" href="https://github.com/RasaHQ/rasa_core/issues">GitHub repository</a>.</p>
<div id="livechat">
   <!--Start of Tawk.to Script-->
   <script type="text/javascript">
      var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
      (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/5b85a455afc2c34e96e7fedd/default';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
      })();
   </script>
   <!--End of Tawk.to Script-->
</div></div>
</div>


	    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
	    <script type="text/javascript"> docsearch({
	     apiKey: '1f9e0efb89e98543f6613a60f847b176',
	     indexName: 'rasa',
	     inputSelector: 'body > div.nav-top > .nav-container > .nav > input',
	     debug: false // Set debug to true if you want to inspect the dropdown
	    });
	    </script>
          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Rasa Technologies GmbH | <a href="https://rasa.com/imprint/" target="_blank">Imprint</a> | <a href="https://rasa.com/privacy-policy/" target="_blank">Privacy Policy</a>
      

    </div>

    

  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag(...arguments) {
      dataLayer.push(...arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-87333416-1', {
      'anonymize_ip': true,
    });
  </script>
  <script src="https://rasa.com/assets/js/js.cookies.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- TODO: Re-Enable once Klaro is re-activated again. Remove the next two lines, then.
  <script type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://www.googletagmanager.com/gtag/js?id=UA-87333416-1"></script>
  <script type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://rasa.com/assets/js/userId.js"></script>
  -->
  <script src="https://www.googletagmanager.com/gtag/js?id=UA-87333416-1"></script>
  <script src="https://rasa.com/assets/js/userId.js"></script>
  <script type="text/javascript">
    var clipboard = new ClipboardJS('.copyable');
    clipboard.on('success', function(e) {
      gtag('event', e.action, {
        'event_category': 'code',
        'event_label': e.text
      });
      const id = e.text.slice(0,3);
      document.getElementById(id).classList.add('visible');
      setTimeout(function(){
        document.getElementById(id).classList.remove('visible');},
        800
      );
    });
    clipboard.on('error', function(e) {
      console.log(e);
    });
  </script>

  <!-- onsite anchor fix (otherwise anchors scroll to far) -->
  <script>
    /* Adapted from https://stackoverflow.com/a/13067009/1906073 */
    (function(document, history, location) {
      var HISTORY_SUPPORT = !!(history && history.pushState);

      var anchorScrolls = {
        ANCHOR_REGEX: /^#[^ ]+$/,
        OFFSET_HEIGHT_PX: 66,

        /**
         * Establish events, and fix initial scroll position if a hash is provided.
         */
        init: function() {
          this.scrollToCurrent();
          $(window).on('hashchange', $.proxy(this, 'scrollToCurrent'));
          $('body').on('click', 'a', $.proxy(this, 'delegateAnchors'));
        },

        /**
         * Return the offset amount to deduct from the normal scroll position.
         * Modify as appropriate to allow for dynamic calculations
         */
        getFixedOffset: function() {
          return this.OFFSET_HEIGHT_PX;
        },

        /**
         * If the provided href is an anchor which resolves to an element on the
         * page, scroll to it.
         * @param  {String} href
         * @return {Boolean} - Was the href an anchor.
         */
        scrollIfAnchor: function(href, pushToHistory) {
          var match, anchorOffset;

          if(!this.ANCHOR_REGEX.test(href)) {
            return false;
          }

          match = document.getElementById(href.slice(1));

          if(match) {
            anchorOffset = $(match).offset().top - this.getFixedOffset();
            $('html, body').animate({ scrollTop: anchorOffset});

            // Add the state to history as-per normal anchor links
            if(HISTORY_SUPPORT && pushToHistory) {
              history.pushState({}, document.title, location.pathname + href);
            }
          }

          return !!match;
        },

        /**
         * Attempt to scroll to the current location's hash.
         */
        scrollToCurrent: function(e) {
          if(this.scrollIfAnchor(window.location.hash) && e) {
            e.preventDefault();
          }
        },

        /**
         * If the click event's target was an anchor, fix the scroll position.
         */
        delegateAnchors: function(e) {
          var elem = e.target;

          if(this.scrollIfAnchor(elem.getAttribute('href'), true)) {
            e.preventDefault();
          }
        }
      };

      $(document).ready($.proxy(anchorScrolls, 'init'));
    })(window.document, window.history, window.location);

  </script>

  <div id="webchat">
  <script src="https://storage.googleapis.com/mrbot-cdn/webchat-0.4.1.js"></script>
  <script>
   WebChat.default.init({
       selector: "#webchat",
       initPayload: "/greet",
       socketUrl: "https://website-demo.rasa.com/",
       title: "",
       subtitle: "",
       profileAvatar: "https://rasa.com/assets/img/demo/rasa_avatar.png",
       showCloseButton: true,
       fullScreenMode: false,})
  </script>
  </div>
  </body>
</html>