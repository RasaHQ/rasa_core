
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Chat &amp; Voice platforms</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/banner.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Actions" href="../customactions/" />
    <link rel="prev" title="High-Level Architecture" href="../architecture/" />

 <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MMHSZCS');</script>
    <!-- End Google Tag Manager -->
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
  <meta itemprop="image" content="https://rasa.com/assets/img/facebook-og.png">
  <meta property="og:title" content="Chat &amp; Voice platforms" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rasa.com/assets/img/facebook-og.png" />
  <meta property="og:url" content="https://rasa.com/docs/core/connectors" />
  
    <meta name="description" content="None" />
    <meta itemprop="description" content="None">
    <meta name="twitter:description" content="None" />
    <meta property="og:description" content="None" />
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@Rasa_HQ">
  <meta name="twitter:title" content="Chat &amp; Voice platforms">
  <meta name="twitter:creator" content="@Rasa_HQ">
  <meta name="twitter:image" content="https://rasa.com/assets/img/facebook-og.png">

  <link rel="stylesheet" href="../_static/xq-light.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fontawesome/css/fontawesome-all.css" type="text/css" />
  <!--<script defer type="text/javascript" src="../_static/config.js"></script>
  <script defer type="text/javascript" src="../_static/klaro.js"></script>-->
  <script type="text/javascript" src="https://storage.googleapis.com/docs-theme/clipboard.min.js"></script>
  
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


  </head><body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MMHSZCS" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="nav-top">
  <div class="nav-container">
    <a href="/docs" class="brand-link">
        <h1 class="brand">
            <img src="../_static/rasa_logo.svg" width="80px" height="40px" title="Rasa logo" alt="Rasa logo">
        </h1>
        <span class="logo extension">docs</span>
    </a>

    <ul class="nav">
      <input type="text" class="search" placeholder="Search">
      
        
          <li><a href=/docs/nlu/>NLU</a></li>
        
      
        
          <li class="active"><a href=/docs/core/>Core</a></li>
        
      
        
          <li><a href=/docs/platform/>Platform</a></li>
        
      

      <li>
        <a href="https://forum.rasa.com" target="_blank"><button class="button btn-ghost btn-small">Join Community</button></a>
      </li>

    </ul>
  </div>
</div>

  <div class="sidebar-extended"></div>
  <div class="document">

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture/">High-Level Architecture</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Chat &amp; Voice platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../customactions/">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slots/">Using Slots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slotfilling/">Slot Filling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../responses/">Bot Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive_learning/">Interactive Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fallbacks/">Fallback Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../policies/">Training and Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging/">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation/">Evaluating and Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../domains/">Domain Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stories/">Story Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/slots_api/">Slot Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/agent/">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/events/">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tracker/">Dialogue State Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/interpreter/">Interpreters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/policy/">Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/featurizer/">Featurization</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../migrations/">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../brokers/">Event Brokers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/">Using Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/">Getting Support</a></li>
</ul>

<div class="versions">
    <p class="caption">Versions</p>
    <div class="versions-content">
      <div>
        <span class="current-version">
          viewing: 0.11.8
        </span>
      </div>
      <div class="other-versions">
          <p>tags</p>
          <div class="dropdown-content">
              <a href="../../0.12.0/connectors/">0.12.0</a>
              <a href="../../0.11.12/connectors/">0.11.12</a>
              <a href="../../0.11.11/connectors/">0.11.11</a>
              <a href="../../0.11.10/connectors/">0.11.10</a>
              <a href="../../0.11.9/connectors/">0.11.9</a>
              <a href="../../0.11.8/connectors/">0.11.8</a>
              <a href="../../0.11.7/connectors/">0.11.7</a>
              <a href="../../0.11.6/connectors/">0.11.6</a>
              <a href="../../0.11.5/connectors/">0.11.5</a>
              <a href="../../0.11.4/connectors/">0.11.4</a>
              <a href="../../0.11.3/connectors/">0.11.3</a>
              <a href="../../0.11.2/connectors/">0.11.2</a>
              <a href="../../0.11.1/connectors/">0.11.1</a>
              <a href="../../0.11.0/connectors/">0.11.0</a>
              <a href="../../0.10.4/connectors/">0.10.4</a>
              <a href="../../0.9.8/connectors/">0.9.8</a>
              <a href="../../0.8.6/connectors/">0.8.6</a>
              <a href="../../0.7.9/connectors/">0.7.9</a>
              <a href="../../0.6.9/connectors/">0.6.9</a>
          </div>
          <p>branches</p>
          <div class="dropdown-content">
              <a href="../../master/connectors/">master</a>
          </div>
      </div>
    </div>
</div>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  


    
    



    <p class="scv-banner"><a href="../../0.12.0/connectors/"><b>Warning:</b> This document is for an old version of Rasa Core. The latest version is 0.12.0.</a></p>
<div class="section" id="chat-voice-platforms">
<span id="connectors"></span><h1><a class="toc-backref" href="#id20">Chat &amp; Voice platforms</a><a class="headerlink" href="#chat-voice-platforms" title="Permalink to this headline">¶</a></h1>
<p>Here’s how to connect your conversational AI to the outside world.</p>
<p>See <a class="reference internal" href="#custom-channels"><span class="std std-ref">here</span></a> for details on how to build a
custom input channel.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#chat-voice-platforms" id="id20">Chat &amp; Voice platforms</a><ul>
<li><a class="reference internal" href="#managing-credentials" id="id21">Managing Credentials</a></li>
<li><a class="reference internal" href="#facebook-setup" id="id22">Facebook Setup</a><ul>
<li><a class="reference internal" href="#getting-credentials" id="id23">Getting Credentials</a></li>
<li><a class="reference internal" href="#using-the-run-script" id="id24">Using the run script</a></li>
<li><a class="reference internal" href="#directly-using-python" id="id25">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#slack-setup" id="id26">Slack Setup</a><ul>
<li><a class="reference internal" href="#id1" id="id27">Getting Credentials</a></li>
<li><a class="reference internal" href="#using-run-script" id="id28">Using run script</a></li>
<li><a class="reference internal" href="#id2" id="id29">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mattermost-setup" id="id30">Mattermost Setup</a><ul>
<li><a class="reference internal" href="#id3" id="id31">Getting Credentials</a></li>
<li><a class="reference internal" href="#id4" id="id32">Using run script</a></li>
<li><a class="reference internal" href="#id5" id="id33">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#telegram-setup" id="id34">Telegram Setup</a><ul>
<li><a class="reference internal" href="#id6" id="id35">Getting Credentials</a></li>
<li><a class="reference internal" href="#id7" id="id36">Using run script</a></li>
<li><a class="reference internal" href="#id8" id="id37">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#twilio-setup" id="id38">Twilio Setup</a><ul>
<li><a class="reference internal" href="#id9" id="id39">Getting Credentials</a></li>
<li><a class="reference internal" href="#id10" id="id40">Using run script</a></li>
<li><a class="reference internal" href="#id11" id="id41">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rocketchat-setup" id="id42">RocketChat Setup</a><ul>
<li><a class="reference internal" href="#id12" id="id43">Getting Credentials</a></li>
<li><a class="reference internal" href="#id13" id="id44">Using run script</a></li>
<li><a class="reference internal" href="#id14" id="id45">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#microsoft-bot-framework-setup" id="id46">Microsoft Bot Framework Setup</a><ul>
<li><a class="reference internal" href="#id15" id="id47">Using run script</a></li>
<li><a class="reference internal" href="#id16" id="id48">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#socketio-setup" id="id49">SocketIO Setup</a><ul>
<li><a class="reference internal" href="#id17" id="id50">Using run script</a></li>
<li><a class="reference internal" href="#id18" id="id51">Directly using python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-ngrok-for-local-testing" id="id52">Using Ngrok For Local Testing</a></li>
<li><a class="reference internal" href="#rest-channels" id="id53">REST Channels</a><ul>
<li><a class="reference internal" href="#restinput" id="id54">RestInput</a></li>
<li><a class="reference internal" href="#callbackinput" id="id55">CallbackInput</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-new-channel" id="id56">Creating a new Channel</a></li>
<li><a class="reference internal" href="#have-questions-or-feedback" id="id57">Have questions or feedback?</a></li>
</ul>
</li>
</ul>
</div>
<p>Input channels are defined in the <code class="docutils literal notranslate"><span class="pre">rasa_core.channels</span></code> module.
Currently, there is code for connecting to
facebook, slack, telegram, mattermost and twilio. If the connection
you want is missing, this is a great place to start contributing!</p>
<p>If you’re testing on your local machine (e.g. not a server), you
will need to use <a class="reference internal" href="#ngrok">ngrok</a>. This gives your machine a domain name
and so that facebook, slack, etc. know where to send messages.</p>
<div class="section" id="managing-credentials">
<h2><a class="toc-backref" href="#id21">Managing Credentials</a><a class="headerlink" href="#managing-credentials" title="Permalink to this headline">¶</a></h2>
<p>To connect to most channels, you will need to add some credentials
(e.g. an API token). Rasa Core will read these properties from a
credentials file in yaml format, here is an example containing most
channels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">twillio</span><span class="p">:</span>
  <span class="n">account_sid</span><span class="p">:</span> <span class="s2">&quot;ACbc2dxxxxxxxxxxxx19d54bdcd6e41186&quot;</span>
  <span class="n">auth_token</span><span class="p">:</span> <span class="s2">&quot;e231c197493a7122d475b4xxxxxxxxxx&quot;</span>
  <span class="n">twilio_number</span><span class="p">:</span> <span class="s2">&quot;+440123456789&quot;</span>

<span class="n">slack</span><span class="p">:</span>
  <span class="n">slack_token</span><span class="p">:</span> <span class="s2">&quot;xoxb-286425452756-safjasdf7sl38KLls&quot;</span>
  <span class="n">slack_channel</span><span class="p">:</span> <span class="s2">&quot;@my_channel&quot;</span>
  
<span class="n">telegram</span><span class="p">:</span>
  <span class="n">access_token</span><span class="p">:</span> <span class="s2">&quot;490161424:AAGlRxinBRtKGb21_rlOEMtDFZMXBl6EC0o&quot;</span>
  <span class="n">verify</span><span class="p">:</span> <span class="s2">&quot;your_bot&quot;</span>
  <span class="n">webhook_url</span><span class="p">:</span> <span class="s2">&quot;your_url.com/webhook&quot;</span>

<span class="n">mattermost</span><span class="p">:</span>
  <span class="n">url</span><span class="p">:</span> <span class="s2">&quot;https://chat.example.com/api/v4&quot;</span>
  <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;community&quot;</span>
  <span class="n">user</span><span class="p">:</span> <span class="s2">&quot;user@user.com&quot;</span>
  <span class="n">pw</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span>

<span class="n">facebook</span><span class="p">:</span>
  <span class="n">verify</span><span class="p">:</span> <span class="s2">&quot;rasa-bot&quot;</span>
  <span class="n">secret</span><span class="p">:</span> <span class="s2">&quot;3e34709d01ea89032asdebfe5a74518&quot;</span>
  <span class="n">page</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">token</span><span class="p">:</span> <span class="s2">&quot;EAAbHPa7H9rEBAAuFk4Q3gPKbDedQnx4djJJ1JmQ7CAqO4iJKrQcNT0wtD&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You only need to include the channels you want to connect to in
your <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code>.</p>
</div>
</div>
<div class="section" id="facebook-setup">
<span id="facebook-connector"></span><h2><a class="toc-backref" href="#id22">Facebook Setup</a><a class="headerlink" href="#facebook-setup" title="Permalink to this headline">¶</a></h2>
<p>You first need to retrieve some credentials to connect to the
Facebook Messenger. Once you have them you can
<strong>either</strong> attach the input channel running the provided <code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code>
script, or you can attach it in your own code.</p>
<div class="section" id="getting-credentials">
<h3><a class="toc-backref" href="#id23">Getting Credentials</a><a class="headerlink" href="#getting-credentials" title="Permalink to this headline">¶</a></h3>
<p><strong>How to get the FB credentials:</strong>
You need to set up a Facebook app and a page.</p>
<blockquote>
<div><ol class="arabic simple">
<li>To create the app go to: <a class="reference external" href="https://developers.facebook.com/">https://developers.facebook.com/</a>
and click on <em>“Add a new app”</em>.</li>
<li>go onto the dashboard for the app and under <em>Products</em>,
click <em>Add Product</em> and <em>add Messenger</em>. Under the settings for
Messenger, scroll down to <em>Token Generation</em> and click on the
link to create a new page for your app.</li>
<li>Use the collected <code class="docutils literal notranslate"><span class="pre">verify</span></code>, <code class="docutils literal notranslate"><span class="pre">secret</span></code> and <code class="docutils literal notranslate"><span class="pre">access</span> <span class="pre">token</span></code>
to connect your bot to facebook.</li>
</ol>
</div></blockquote>
<p>For more detailed steps, visit the
<a class="reference external" href="https://developers.facebook.com/docs/graph-api/webhooks">messenger docs</a>.</p>
</div>
<div class="section" id="using-the-run-script">
<h3><a class="toc-backref" href="#id24">Using the run script</a><a class="headerlink" href="#using-the-run-script" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to facebook using the run script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current <span class="se">\</span>
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">facebook</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">verify</span><span class="p p-Indicator">:</span> <span class="s">&quot;rasa-bot&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">secret</span><span class="p p-Indicator">:</span> <span class="s">&quot;3e34709d01ea89032asdebfe5a74518&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">page-access-token</span><span class="p p-Indicator">:</span> <span class="s">&quot;EAAbHPa7H9rEBAAuFk4Q3gPKbDedQnx4djJJ1JmQ7CAqO4iJKrQcNT0wtD&quot;</span>
</pre></div>
</div>
<p>The endpoint for receiving facebook messenger messages is
<code class="docutils literal notranslate"><span class="pre">http://localhost:5005/webhooks/facebook/webhook</span></code>, replacing
the host and port with the appropriate values. This is the URL
you should add in the configuration of the webhook.</p>
</div>
<div class="section" id="directly-using-python">
<h3><a class="toc-backref" href="#id25">Directly using python</a><a class="headerlink" href="#directly-using-python" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">FacebookInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you separate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a Messenger-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.facebook</span> <span class="k">import</span> <span class="n">FacebookInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">FacebookInput</span><span class="p">(</span>
            <span class="n">fb_verify</span><span class="o">=</span><span class="s2">&quot;YOUR_FB_VERIFY&quot;</span><span class="p">,</span>
            <span class="c1"># you need tell facebook this token, to confirm your URL</span>
            <span class="n">fb_secret</span><span class="o">=</span><span class="s2">&quot;YOUR_FB_SECRET&quot;</span><span class="p">,</span>  <span class="c1"># your app secret</span>
            <span class="n">fb_access_token</span><span class="o">=</span><span class="s2">&quot;YOUR_FB_PAGE_ACCESS_TOKEN&quot;</span>
            <span class="c1"># token for the page you subscribed to</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="slack-setup">
<span id="slack-connector"></span><h2><a class="toc-backref" href="#id26">Slack Setup</a><a class="headerlink" href="#slack-setup" title="Permalink to this headline">¶</a></h2>
<p>You first need to retrieve some credentials, once you have them you can
<strong>either</strong> attach the input channel running the provided <code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code>
script, or you can attach it in your own code.</p>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id27">Getting Credentials</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>How to get the Slack credentials:</strong> You need to set up a Slack app.</p>
<blockquote>
<div><ol class="arabic simple">
<li>To create the app go to: <a class="reference external" href="https://api.slack.com/apps">https://api.slack.com/apps</a> and click
on <em>“Create New App”</em>.</li>
<li>Activate the following features: interactive components, event
subscriptions, bot users, permissions (for basic functionality
you should subscribe to the <code class="docutils literal notranslate"><span class="pre">message.channel</span></code>,
<code class="docutils literal notranslate"><span class="pre">message.groups</span></code>, <code class="docutils literal notranslate"><span class="pre">message.im</span></code> and <code class="docutils literal notranslate"><span class="pre">message.mpim</span></code> events)</li>
<li>The <code class="docutils literal notranslate"><span class="pre">slack_channel</span></code> is the target your bot posts to.
This can be a channel, an app or an individual person</li>
<li>Use the entry for <code class="docutils literal notranslate"><span class="pre">Bot</span> <span class="pre">User</span> <span class="pre">OAuth</span> <span class="pre">Access</span> <span class="pre">Token</span></code> in the
“OAuth &amp; Permissions” tab as your <code class="docutils literal notranslate"><span class="pre">slack_token</span></code></li>
</ol>
</div></blockquote>
<p>For more detailed steps, visit the
<a class="reference external" href="https://api.slack.com/incoming-webhooks">slack api docs</a>.</p>
</div>
<div class="section" id="using-run-script">
<h3><a class="toc-backref" href="#id28">Using run script</a><a class="headerlink" href="#using-run-script" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to the slack input channel using the run
script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current <span class="se">\</span>
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">slack</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">slack_token</span><span class="p p-Indicator">:</span> <span class="s">&quot;xoxb-286425452756-safjasdf7sl38KLls&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">slack_channel</span><span class="p p-Indicator">:</span> <span class="s">&quot;@my_channel&quot;</span>
</pre></div>
</div>
<p>The endpoint for receiving facebook messenger messages is
<code class="docutils literal notranslate"><span class="pre">http://localhost:5005/webhooks/slack/webhook</span></code>, replacing
the host and port with the appropriate values. This is the URL
you should add in the OAuth &amp; Permissions section.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you do not set the slack_channel keyword
argument, messages will by delivered back to
the user who sent them.</p>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id29">Directly using python</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">SlackInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you separate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a Messenger-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.slack</span> <span class="k">import</span> <span class="n">SlackInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">SlackInput</span><span class="p">(</span>
            <span class="n">slack_token</span><span class="o">=</span><span class="s2">&quot;YOUR_SLACK_TOKEN&quot;</span><span class="p">,</span>
            <span class="c1"># this is the `bot_user_o_auth_access_token`</span>
            <span class="n">slack_channel</span><span class="o">=</span><span class="s2">&quot;YOUR_SLACK_CHANNEL&quot;</span>
            <span class="c1"># the name of your channel to which the bot posts (optional)</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mattermost-setup">
<span id="mattermost-connector"></span><h2><a class="toc-backref" href="#id30">Mattermost Setup</a><a class="headerlink" href="#mattermost-setup" title="Permalink to this headline">¶</a></h2>
<p>You first need to retrieve some credentials, once you have them you can
<strong>either</strong> attach the input channel running the provided <code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code>
script, or you can attach it in your own code.</p>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id31">Getting Credentials</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p><strong>How to setup the outgoing webhook:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>To create the mattermost outgoing webhook login to your mattermost
team site and go to <strong>Main Menu &gt; Integrations &gt; Outgoing Webhooks</strong></li>
<li>Click <strong>Add outgoing webhook</strong></li>
<li>Fill out the details including the channel you want the bot in.
You will need to ensure the <strong>trigger words</strong> section is setup
with &#64;yourbotname so that way it doesn’t trigger on everything
that is said.</li>
<li>Make sure <strong>trigger when</strong> section is set to value
<strong>first word matches a trigger word exactly</strong></li>
<li>For the callback url this needs to be your ngrok url where you
have your webhook running in core or your public address, e.g.
<code class="docutils literal notranslate"><span class="pre">http://test.example.com/webhooks/mattermost/webhook</span></code></li>
</ol>
</div></blockquote>
<p>For more detailed steps, visit the
<a class="reference external" href="https://docs.mattermost.com/guides/developer.html">mattermost docs at</a>.</p>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id32">Using run script</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to the mattermost input channel using the
run script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current <span class="se">\</span>
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">mattermost</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">url</span><span class="p p-Indicator">:</span> <span class="s">&quot;https://chat.example.com/api/v4&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">team</span><span class="p p-Indicator">:</span> <span class="s">&quot;community&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="s">&quot;user@user.com&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">pw</span><span class="p p-Indicator">:</span> <span class="s">&quot;password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id33">Directly using python</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">MattermostInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you separate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a Mattermost-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.mattermost</span> <span class="k">import</span> <span class="n">MattermostInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">MattermostInput</span><span class="p">(</span>
            <span class="c1"># this is the url of the api for your mattermost instance</span>
            <span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://chat.example.com/api/v4&quot;</span><span class="p">,</span>
            <span class="c1"># the name of your team for mattermost</span>
            <span class="n">team</span><span class="o">=</span><span class="s2">&quot;community&quot;</span><span class="p">,</span>
            <span class="c1"># the username of your bot user that will post</span>
            <span class="n">user</span><span class="o">=</span><span class="s2">&quot;user@email.com&quot;</span><span class="p">,</span>
            <span class="c1"># messages</span>
            <span class="n">pw</span><span class="o">=</span><span class="s2">&quot;password&quot;</span>
            <span class="c1"># the password of your bot user that will post messages</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments for the <code class="docutils literal notranslate"><span class="pre">handle_channels</span></code> are the input channels and
the port. The endpoint for receiving mattermost channel messages
is <code class="docutils literal notranslate"><span class="pre">/webhooks/mattermost/webhook</span></code>. This is the url you should
add in the mattermost outgoing webhook.</p>
</div>
</div>
<div class="section" id="telegram-setup">
<span id="telegram-connector"></span><h2><a class="toc-backref" href="#id34">Telegram Setup</a><a class="headerlink" href="#telegram-setup" title="Permalink to this headline">¶</a></h2>
<p>You first need to retrieve some credentials, once you have them you can
<strong>either</strong> attach the input channel running the provided <code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code>
script, or you can attach it in your own code.</p>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id35">Getting Credentials</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><strong>How to get the Telegram credentials:</strong>
You need to set up a Telegram bot.</p>
<blockquote>
<div><ol class="arabic simple">
<li>To create the bot, go to: <a class="reference external" href="https://web.telegram.org/#/im">https://web.telegram.org/#/im</a><a class="reference external" href="mailto:?p=&#37;&#52;&#48;BotFather">?p=<span>&#64;</span>BotFather</a>,
enter <em>/newbot</em> and follow the instructions.</li>
<li>At the end you should get your <code class="docutils literal notranslate"><span class="pre">access_token</span></code> and the username you
set will be your <code class="docutils literal notranslate"><span class="pre">verify</span></code>.</li>
<li>If you want to use your bot in a group setting, it’s advisable to
turn on group privacy mode by entering <em>/setprivacy</em>. Then the bot
will only listen when the message is started with <em>/bot</em></li>
</ol>
</div></blockquote>
<p>For more information on the Telegram HTTP API, go to
<a class="reference external" href="https://core.telegram.org/bots/api">https://core.telegram.org/bots/api</a></p>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id36">Using run script</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to telegram using the run script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">telegram</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">access_token</span><span class="p p-Indicator">:</span> <span class="s">&quot;490161424:AAGlRxinBRtKGb21_rlOEMtDFZMXBl6EC0o&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">verify</span><span class="p p-Indicator">:</span> <span class="s">&quot;your_bot&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">webhook_url</span><span class="p p-Indicator">:</span> <span class="s">&quot;your_url.com/webhooks/telegram/webhook&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id37">Directly using python</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">TelegramInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you separate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a Messenger-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># telegram channel will try to set a webhook, so we need to mock the api</span>

    <span class="n">httpretty</span><span class="o">.</span><span class="n">register_uri</span><span class="p">(</span>
            <span class="n">httpretty</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span>
            <span class="s1">&#39;https://api.telegram.org/bot123:YOUR_ACCESS_TOKEN/setWebhook&#39;</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="s1">&#39;{&quot;ok&quot;: true, &quot;result&quot;: </span><span class="si">{}</span><span class="s1">}&#39;</span><span class="p">)</span>

    <span class="n">httpretty</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

    <span class="kn">from</span> <span class="nn">rasa_core.channels.telegram</span> <span class="k">import</span> <span class="n">TelegramInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">TelegramInput</span><span class="p">(</span>
            <span class="c1"># you get this when setting up a bot</span>
            <span class="n">access_token</span><span class="o">=</span><span class="s2">&quot;123:YOUR_ACCESS_TOKEN&quot;</span><span class="p">,</span>
            <span class="c1"># this is your bots username</span>
            <span class="n">verify</span><span class="o">=</span><span class="s2">&quot;YOUR_TELEGRAM_BOT&quot;</span><span class="p">,</span>
            <span class="c1"># the url your bot should listen for messages</span>
            <span class="n">webhook_url</span><span class="o">=</span><span class="s2">&quot;YOUR_WEBHOOK_URL&quot;</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments for the <code class="docutils literal notranslate"><span class="pre">handle_channels</span></code> are the input channels and
the port. The endpoint for receiving telegram channel messages
is <code class="docutils literal notranslate"><span class="pre">/webhooks/telegram/webhook</span></code>. This is the URL you should use
as the <code class="docutils literal notranslate"><span class="pre">webhook_url</span></code>. To get the bot to listen for messages at
that URL, go to <code class="docutils literal notranslate"><span class="pre">myurl.com/webhooks/telegram/set_webhook</span></code>
first to set the webhook.</p>
</div>
</div>
<div class="section" id="twilio-setup">
<span id="twilio-connector"></span><h2><a class="toc-backref" href="#id38">Twilio Setup</a><a class="headerlink" href="#twilio-setup" title="Permalink to this headline">¶</a></h2>
<p>You first need to retrieve some credentials, once you have them you can
<strong>either</strong> attach the input channel running the provided <code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code>
script, or you can attach it in your own code.</p>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id39">Getting Credentials</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p><strong>How to get the Twilio credentials:</strong>
You need to set up a Twilio account.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Once you have created a Twilio account, you need to create a new
project. The basic important product to select here
is <code class="docutils literal notranslate"><span class="pre">Programmable</span> <span class="pre">SMS</span></code>.</li>
<li>Once you have created the project, navigate to the Dashboard of
<code class="docutils literal notranslate"><span class="pre">Programmable</span> <span class="pre">SMS</span></code> and click on <code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Started</span></code> and follow the
steps to connect a phone number to the project.</li>
<li>Now you can use the <code class="docutils literal notranslate"><span class="pre">Account</span> <span class="pre">SID</span></code>, <code class="docutils literal notranslate"><span class="pre">Auth</span> <span class="pre">Token</span></code> and the phone
number you purchased in your credentials yml.</li>
</ol>
</div></blockquote>
<p>For more information on the Twilio REST API, go to
<a class="reference external" href="https://www.twilio.com/docs/iam/api">https://www.twilio.com/docs/iam/api</a></p>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id40">Using run script</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to the twilio input channel using the run
script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">twillio</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">account_sid</span><span class="p p-Indicator">:</span> <span class="s">&quot;ACbc2dxxxxxxxxxxxx19d54bdcd6e41186&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">auth_token</span><span class="p p-Indicator">:</span> <span class="s">&quot;e231c197493a7122d475b4xxxxxxxxxx&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">twilio_number</span><span class="p p-Indicator">:</span> <span class="s">&quot;+440123456789&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id41">Directly using python</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">TwilioInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you separate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a Twilio-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.twilio</span> <span class="k">import</span> <span class="n">TwilioInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">TwilioInput</span><span class="p">(</span>
            <span class="c1"># you get this from your twilio account</span>
            <span class="n">account_sid</span><span class="o">=</span><span class="s2">&quot;YOUR_ACCOUNT_SID&quot;</span><span class="p">,</span>
            <span class="c1"># also from your twilio account</span>
            <span class="n">auth_token</span><span class="o">=</span><span class="s2">&quot;YOUR_AUTH_TOKEN&quot;</span><span class="p">,</span>
            <span class="c1"># a number associated with your twilio account</span>
            <span class="n">twilio_number</span><span class="o">=</span><span class="s2">&quot;YOUR_TWILIO_NUMBER&quot;</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments for the <code class="docutils literal notranslate"><span class="pre">handle_channels</span></code> are the input channels and
the port. The endpoint for receiving twilio channel messages
is <code class="docutils literal notranslate"><span class="pre">/webhooks/twilio/webhook</span></code>.</p>
</div>
</div>
<div class="section" id="rocketchat-setup">
<span id="rocketchat-connector"></span><h2><a class="toc-backref" href="#id42">RocketChat Setup</a><a class="headerlink" href="#rocketchat-setup" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id43">Getting Credentials</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p><strong>How to set up Rocket.Chat:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Create a user that will be used to post messages and set its
credentials at credentials file.</li>
<li>Create a Rocket.Chat outgoing webhook by logging as admin to
Rocket.Chat and going to
<strong>Administration &gt; Integrations &gt; New Integration</strong>.</li>
<li>Select <strong>Outgoing Webhook</strong>.</li>
<li>Set <strong>Event Trigger</strong> section to value <strong>Message Sent</strong>.</li>
<li>Fill out the details including the channel you want the bot
listen to. Optionally, it is possible to set the
<strong>Trigger Words</strong> section with <code class="docutils literal notranslate"><span class="pre">&#64;yourbotname</span></code> so that way it
doesn’t trigger on everything that is said.</li>
<li>Set your <strong>URLs</strong> section to the Rasa URL where you have your
webhook running, in Core or your public address with
<code class="docutils literal notranslate"><span class="pre">/webhooks/rocketchat/webhook</span></code>, e.g.:
<code class="docutils literal notranslate"><span class="pre">http://test.example.com/webhooks/rocketchat/webhook</span></code>.</li>
</ol>
</div></blockquote>
<p>For more information on the Rocket.Chat Webhooks, go to
<a class="reference external" href="https://rocket.chat/docs/administrator-guides/integrations/">https://rocket.chat/docs/administrator-guides/integrations/</a></p>
</div>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id44">Using run script</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to the rocketchat input channel using the run
script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">rocketchat</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="s">&quot;yourbotname&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="s">&quot;YOUR_PASSWORD&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">server_url</span><span class="p p-Indicator">:</span> <span class="s">&quot;https://demo.rocket.chat&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id45">Directly using python</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">RocketChatInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you separate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a RocketChat-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.rocketchat</span> <span class="k">import</span> <span class="n">RocketChatInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">RocketChatInput</span><span class="p">(</span>
            <span class="c1"># your bots rocket chat user name</span>
            <span class="n">user</span><span class="o">=</span><span class="s2">&quot;yourbotname&quot;</span><span class="p">,</span>
            <span class="c1"># the password for your rocket chat bots account</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;YOUR_PASSWORD&quot;</span><span class="p">,</span>
            <span class="c1"># url where your rocket chat instance is running</span>
            <span class="n">server_url</span><span class="o">=</span><span class="s2">&quot;https://demo.rocket.chat&quot;</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments for the <code class="docutils literal notranslate"><span class="pre">handle_channels</span></code> are the input channels and
the port. The endpoint for receiving mattermost channel messages
is <code class="docutils literal notranslate"><span class="pre">/webhooks/rocketchat/webhook</span></code>. This is the url you should add in the
RocketChat outgoing webhook.</p>
</div>
</div>
<div class="section" id="microsoft-bot-framework-setup">
<span id="botframework-connector"></span><h2><a class="toc-backref" href="#id46">Microsoft Bot Framework Setup</a><a class="headerlink" href="#microsoft-bot-framework-setup" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id15">
<h3><a class="toc-backref" href="#id47">Using run script</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect to the botframework input channel using the
run script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current <span class="se">\</span>
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">botframework</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">app_id</span><span class="p p-Indicator">:</span> <span class="s">&quot;MICROSOFT_APP_ID&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">app_password</span><span class="p p-Indicator">:</span> <span class="s">&quot;MICROSOFT_APP_PASSWORD&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id48">Directly using python</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">BotFrameworkInput</span></code> instance provides a flask blueprint for creating
a webserver. This lets you seperate the exact endpoints and implementation
from your webserver creation logic.</p>
<p>Code to create a Microsoft Bot Framework-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.botframework</span> <span class="k">import</span> <span class="n">BotFrameworkInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">BotFrameworkInput</span><span class="p">(</span>
            <span class="c1"># you get this from your Bot Framework account</span>
            <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;MICROSOFT_APP_ID&quot;</span><span class="p">,</span>
            <span class="c1"># also from your Bot Framework account</span>
            <span class="n">app_password</span><span class="o">=</span><span class="s2">&quot;MICROSOFT_APP_PASSWORD&quot;</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments for the <code class="docutils literal notranslate"><span class="pre">handle_channels</span></code> are the input channels and
the port. The endpoint for receiving botframework channel messages
is <code class="docutils literal notranslate"><span class="pre">/webhooks/botframework/webhook</span></code>. This is the url you should
add in your microsoft bot service configuration.</p>
</div>
</div>
<div class="section" id="socketio-setup">
<span id="socketio-connector"></span><h2><a class="toc-backref" href="#id49">SocketIO Setup</a><a class="headerlink" href="#socketio-setup" title="Permalink to this headline">¶</a></h2>
<p>You can <strong>either</strong> attach the input channel running the provided
<code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code> script, or you can attach the channel in your
own code.</p>
<div class="section" id="id17">
<h3><a class="toc-backref" href="#id50">Using run script</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>If you want to connect the socketio input channel using the run
script, e.g. using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">socketio</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">user_message_evt</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">user_uttered</span>
  <span class="l l-Scalar l-Scalar-Plain">bot_message_evt</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">bot_uttered</span>
</pre></div>
</div>
<p>These two configuration values define the event names used by Rasa Core
when sending or receiving messages over socket.io.</p>
</div>
<div class="section" id="id18">
<h3><a class="toc-backref" href="#id51">Directly using python</a><a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>Code to create a Socket.IO-compatible webserver looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">rasa_core.channels.socketio</span> <span class="k">import</span> <span class="n">SocketIOInput</span>
    <span class="kn">from</span> <span class="nn">rasa_core.agent</span> <span class="k">import</span> <span class="n">Agent</span>
    <span class="kn">from</span> <span class="nn">rasa_core.interpreter</span> <span class="k">import</span> <span class="n">RegexInterpreter</span>

    <span class="c1"># load your trained agent</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">,</span> <span class="n">interpreter</span><span class="o">=</span><span class="n">RegexInterpreter</span><span class="p">())</span>

    <span class="n">input_channel</span> <span class="o">=</span> <span class="n">SocketIOInput</span><span class="p">(</span>
            <span class="c1"># event name for messages sent from the user</span>
            <span class="n">user_message_evt</span><span class="o">=</span><span class="s2">&quot;user_uttered&quot;</span><span class="p">,</span>
            <span class="c1"># event name for messages sent from the bot</span>
            <span class="n">bot_message_evt</span><span class="o">=</span><span class="s2">&quot;bot_uttered&quot;</span><span class="p">,</span>
            <span class="c1"># socket.io namespace to use for the messages</span>
            <span class="n">namespace</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>

    <span class="c1"># set serve_forever=False if you want to keep the server running</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">handle_channels</span><span class="p">([</span><span class="n">input_channel</span><span class="p">],</span> <span class="mi">5004</span><span class="p">,</span> <span class="n">serve_forever</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments for the <code class="docutils literal notranslate"><span class="pre">handle_channels</span></code> are the input channels and
the port. Once started, you should be able to connect to
<code class="docutils literal notranslate"><span class="pre">http://localhost:5005</span></code> with your socket.io client.</p>
</div>
</div>
<div class="section" id="using-ngrok-for-local-testing">
<span id="ngrok"></span><h2><a class="toc-backref" href="#id52">Using Ngrok For Local Testing</a><a class="headerlink" href="#using-ngrok-for-local-testing" title="Permalink to this headline">¶</a></h2>
<p>You can use <a class="reference external" href="https://ngrok.com/">https://ngrok.com/</a> to create a local webhook from your
machine that is Publicly available on the internet so you can use it
with applications like Slack, Facebook, etc.</p>
<p>The command to run a ngrok instance for port 5002 for example would be:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ngrok httpd <span class="m">5002</span>
</pre></div>
</div>
<p><strong>Ngrok is only needed if you don’t have a public IP and are testing locally</strong></p>
<p>ngrok will create a https address for your computer, for example
<a class="reference external" href="https://xxxxxx.ngrok.io">https://xxxxxx.ngrok.io</a> . For a facebook bot, your webhook address
would then be <a class="reference external" href="https://xxxxxx.ngrok.io/webhooks/facebook/webhook">https://xxxxxx.ngrok.io/webhooks/facebook/webhook</a>,
for telegram <a class="reference external" href="https://xxxxxx.ngrok.io/webhooks/telegram/webhook">https://xxxxxx.ngrok.io/webhooks/telegram/webhook</a>, etc.</p>
</div>
<div class="section" id="rest-channels">
<span id="id19"></span><h2><a class="toc-backref" href="#id53">REST Channels</a><a class="headerlink" href="#rest-channels" title="Permalink to this headline">¶</a></h2>
<p>If you want to put a widget on your website so that people can
talk to your bot, check out these two projects:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/mrbot-ai/rasa-webchat">Rasa Webchat</a>
uses sockets.</li>
<li><a class="reference external" href="https://github.com/scalableminds/chatroom">Chatroom</a>
uses regular HTTP requests.</li>
</ul>
<p>For these use cases it is easiest to use either the <code class="docutils literal notranslate"><span class="pre">RestInput</span></code> or the
<code class="docutils literal notranslate"><span class="pre">CallbackInput</span></code> channels. They will provide you with a URL to post the
messages to.</p>
<div class="section" id="restinput">
<h3><a class="toc-backref" href="#id54">RestInput</a><a class="headerlink" href="#restinput" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rest</span></code> channel, will provide you with a REST endpoint to post messages
to and in response to that request will send back the bots messages.
Here is an example on how to connect the <code class="docutils literal notranslate"><span class="pre">rest</span></code> input channel
using the run script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current <span class="se">\</span>
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">rest</span><span class="p p-Indicator">:</span>
  <span class="c1"># you don&#39;t need to provide anything here - this channel doesn&#39;t</span>
  <span class="c1"># require any credentials</span>
</pre></div>
</div>
<p>After connecting the <code class="docutils literal notranslate"><span class="pre">rest</span></code> input channel, you can post messages to
<code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/webhooks/rest/webhook</span></code> with the following format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Rasa&quot;</span><span class="p">,</span>
  <span class="nt">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hi there!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The response to this request will include the bot responses, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span><span class="nt">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hey Rasa!&quot;</span><span class="p">},</span> <span class="p">{</span><span class="nt">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/image.jpg&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="callbackinput">
<h3><a class="toc-backref" href="#id55">CallbackInput</a><a class="headerlink" href="#callbackinput" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">callback</span></code> channel behaves very much like the <code class="docutils literal notranslate"><span class="pre">rest</span></code> input,
but instead of directly returning the bot messages to the HTTP
request that sends the message, it will call a URL you can specify
to send bot messages.</p>
<p>Here is an example on how to connect the
<code class="docutils literal notranslate"><span class="pre">callback</span></code> input channel using the run script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m rasa_core.run -d models/dialogue -u models/nlu/current <span class="se">\</span>
    --port <span class="m">5002</span> --credentials credentials.yml
</pre></div>
</div>
<p>you need to supply a <code class="docutils literal notranslate"><span class="pre">credentials.yml</span></code> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">callback</span><span class="p p-Indicator">:</span>
  <span class="c1"># URL to which Core will send the bot responses</span>
  <span class="l l-Scalar l-Scalar-Plain">url</span><span class="p p-Indicator">:</span> <span class="s">&quot;http://localhost:5034/bot&quot;</span>
</pre></div>
</div>
<p>After connecting the <code class="docutils literal notranslate"><span class="pre">callback</span></code> input channel, you can post messages to
<code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/webhooks/callback/webhook</span></code> with the following format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Rasa&quot;</span><span class="p">,</span>
  <span class="nt">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hi there!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The response will simply be <code class="docutils literal notranslate"><span class="pre">success</span></code>. Once Core wants to send a
message to the user, it will call the URL you specified with a <code class="docutils literal notranslate"><span class="pre">POST</span></code>
and the following <code class="docutils literal notranslate"><span class="pre">JSON</span></code> body:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span><span class="nt">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hey Rasa!&quot;</span><span class="p">},</span> <span class="p">{</span><span class="nt">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/image.jpg&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-a-new-channel">
<span id="custom-channels"></span><h2><a class="toc-backref" href="#id56">Creating a new Channel</a><a class="headerlink" href="#creating-a-new-channel" title="Permalink to this headline">¶</a></h2>
<p>You can also implement your own, custom channel. You can
use the <code class="docutils literal notranslate"><span class="pre">rasa_core.channels.channel.RestInput</span></code> class as a template.
The methods you need to implement are <code class="docutils literal notranslate"><span class="pre">blueprint</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code>. The method
needs to create a Flask blueprint that can be attached to a flask server.</p>
<p>This allows you to add <cite>REST</cite> endpoints to the server, the external
messaging service can call to deliver messages.</p>
<p>Your blueprint should have at least the two routes <code class="docutils literal notranslate"><span class="pre">health</span></code> on <code class="docutils literal notranslate"><span class="pre">/</span></code>
and <code class="docutils literal notranslate"><span class="pre">receive</span></code> on the http route <code class="docutils literal notranslate"><span class="pre">/webhook</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> method defines the url prefix. E.g. if your component is
named <code class="docutils literal notranslate"><span class="pre">myio</span></code> the webhook you can use to attach the external service is:
<code class="docutils literal notranslate"><span class="pre">http://localhost:5005/webhooks/myio/webhook</span></code> (replacing the hostname
and port with your values).</p>
<p>To send a message, you would run a command like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -XPOST http://localhost:5000/webhooks/myio/webhook <span class="se">\</span>
  -d <span class="s1">&#39;{&quot;sender&quot;: &quot;user1&quot;, &quot;message&quot;: &quot;hello&quot;}&#39;</span> <span class="se">\</span>
  -H <span class="s2">&quot;Content-type: application/json&quot;</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">myio</span></code> is the name of your component.</p>
<p>In your implementation of the <code class="docutils literal notranslate"><span class="pre">receive</span></code> endpoint, you need to make
sure to call <code class="docutils literal notranslate"><span class="pre">on_new_message(UserMessage(text,</span> <span class="pre">output,</span> <span class="pre">sender_id))</span></code>.
This will tell Rasa Core to handle this user message. The <code class="docutils literal notranslate"><span class="pre">output</span></code>
is an output channel implementing the <code class="docutils literal notranslate"><span class="pre">OutputChannel</span></code> class. You can
either implement the methods for your particular chat channel (e.g. there
are methods to send text and images) or you can use the
<code class="docutils literal notranslate"><span class="pre">CollectingOutputChannel</span></code> to collect the bot responses Core
creates while the bot is processing your messages and return
them as part of your endpoint response. This is the way the <code class="docutils literal notranslate"><span class="pre">RestInput</span></code>
is implemented. For examples on how to create and use your own output
channel, please take a look at the implementations of the other
output channels, e.g. the <code class="docutils literal notranslate"><span class="pre">SlackBot</span></code> in <code class="docutils literal notranslate"><span class="pre">rasa_core.channels.slack</span></code>.</p>
<p>To use a custom channel, you can use the <code class="docutils literal notranslate"><span class="pre">rasa_core.run</span></code> script,
passing in the classpath of your custom channel using
<code class="docutils literal notranslate"><span class="pre">--channel</span> <span class="pre">mypackage.MyIO</span></code> or you can write your own code
hooking up the agent with the channel.</p>
<p>Example implementation for an input channel that receives the messages,
hands them over to Rasa Core, collects the bot utterances and returns
these bot utterances as the json response to the webhook call that
posted this message to the channel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RestInput</span><span class="p">(</span><span class="n">InputChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A custom http input channel.</span>

<span class="sd">    This implementation is the basis for a custom implementation of a chat</span>
<span class="sd">    frontend. You can customize this to send messages to Rasa Core and</span>
<span class="sd">    retrieve responses from the agent.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;rest&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">on_message_wrapper</span><span class="p">(</span><span class="n">on_new_message</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">queue</span><span class="p">,</span> <span class="n">sender_id</span><span class="p">):</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">QueueOutputChannel</span><span class="p">(</span><span class="n">queue</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="n">UserMessage</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">collector</span><span class="p">,</span> <span class="n">sender_id</span><span class="p">,</span>
                              <span class="n">input_channel</span><span class="o">=</span><span class="n">RestInput</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
        <span class="n">on_new_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;DONE&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_extract_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># noinspection PyMethodMayBeStatic</span>
    <span class="k">def</span> <span class="nf">_extract_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stream_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_new_message</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">sender_id</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Queue</span>

        <span class="n">q</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_message_wrapper</span><span class="p">,</span>
                   <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">on_new_message</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">sender_id</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&quot;DONE&quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">blueprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on_new_message</span><span class="p">):</span>
        <span class="n">custom_webhook</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span>
                <span class="s1">&#39;custom_webhook_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span>
                <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="nd">@custom_webhook</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
        <span class="k">def</span> <span class="nf">health</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">})</span>

        <span class="nd">@custom_webhook</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/webhook&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
        <span class="k">def</span> <span class="nf">receive</span><span class="p">():</span>
            <span class="n">sender_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_sender</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_message</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="n">should_use_stream</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">bool_arg</span><span class="p">(</span><span class="s2">&quot;stream&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">should_use_stream</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">stream_response</span><span class="p">(</span><span class="n">on_new_message</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">sender_id</span><span class="p">),</span>
                        <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/event-stream&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">collector</span> <span class="o">=</span> <span class="n">CollectingOutputChannel</span><span class="p">()</span>
                <span class="n">on_new_message</span><span class="p">(</span><span class="n">UserMessage</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">collector</span><span class="p">,</span> <span class="n">sender_id</span><span class="p">,</span>
                                           <span class="n">input_channel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()))</span>
                <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">collector</span><span class="o">.</span><span class="n">messages</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">custom_webhook</span>
</pre></div>
</div>
</div>
<div class="section" id="have-questions-or-feedback">
<h2><a class="toc-backref" href="#id57">Have questions or feedback?</a><a class="headerlink" href="#have-questions-or-feedback" title="Permalink to this headline">¶</a></h2>
<p>We have a very active support community on <a class="reference external" href="https://forum.rasa.com">Rasa Community Forum</a>
that is happy to help you with your questions. If you have any feedback for us or a specific
suggestion for improving the docs, feel free to share it by creating an issue on Rasa Core
<a class="reference external" href="https://github.com/RasaHQ/rasa_core/issues">GitHub repository</a>.</p>
<div id="livechat">
   <!--Start of Tawk.to Script-->
   <script type="text/javascript">
      var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
      (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/5b85a455afc2c34e96e7fedd/default';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
      })();
   </script>
   <!--End of Tawk.to Script-->
</div></div>
</div>


	    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
	    <script type="text/javascript"> docsearch({
	     apiKey: '1f9e0efb89e98543f6613a60f847b176',
	     indexName: 'rasa',
	     inputSelector: 'body > div.nav-top > .nav-container > .nav > input',
	     debug: false // Set debug to true if you want to inspect the dropdown
	    });
	    </script>
          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Rasa Technologies GmbH | <a href="https://rasa.com/imprint/" target="_blank">Imprint</a> | <a href="https://rasa.com/privacy-policy/" target="_blank">Privacy Policy</a>
      

    </div>

    

  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag(...arguments) {
      dataLayer.push(...arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-87333416-1', {
      'anonymize_ip': true,
    });
  </script>
  <script src="https://rasa.com/assets/js/js.cookies.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- TODO: Re-Enable once Klaro is re-activated again. Remove the next two lines, then.
  <script type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://www.googletagmanager.com/gtag/js?id=UA-87333416-1"></script>
  <script type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://rasa.com/assets/js/userId.js"></script>
  -->
  <script src="https://www.googletagmanager.com/gtag/js?id=UA-87333416-1"></script>
  <script src="https://rasa.com/assets/js/userId.js"></script>
  <script type="text/javascript">
    var clipboard = new ClipboardJS('.copyable');
    clipboard.on('success', function(e) {
      gtag('event', e.action, {
        'event_category': 'code',
        'event_label': e.text
      });
      const id = e.text.slice(0,3);
      document.getElementById(id).classList.add('visible');
      setTimeout(function(){
        document.getElementById(id).classList.remove('visible');},
        800
      );
    });
    clipboard.on('error', function(e) {
      console.log(e);
    });
  </script>

  <!-- onsite anchor fix (otherwise anchors scroll to far) -->
  <script>
    /* Adapted from https://stackoverflow.com/a/13067009/1906073 */
    (function(document, history, location) {
      var HISTORY_SUPPORT = !!(history && history.pushState);

      var anchorScrolls = {
        ANCHOR_REGEX: /^#[^ ]+$/,
        OFFSET_HEIGHT_PX: 66,

        /**
         * Establish events, and fix initial scroll position if a hash is provided.
         */
        init: function() {
          this.scrollToCurrent();
          $(window).on('hashchange', $.proxy(this, 'scrollToCurrent'));
          $('body').on('click', 'a', $.proxy(this, 'delegateAnchors'));
        },

        /**
         * Return the offset amount to deduct from the normal scroll position.
         * Modify as appropriate to allow for dynamic calculations
         */
        getFixedOffset: function() {
          return this.OFFSET_HEIGHT_PX;
        },

        /**
         * If the provided href is an anchor which resolves to an element on the
         * page, scroll to it.
         * @param  {String} href
         * @return {Boolean} - Was the href an anchor.
         */
        scrollIfAnchor: function(href, pushToHistory) {
          var match, anchorOffset;

          if(!this.ANCHOR_REGEX.test(href)) {
            return false;
          }

          match = document.getElementById(href.slice(1));

          if(match) {
            anchorOffset = $(match).offset().top - this.getFixedOffset();
            $('html, body').animate({ scrollTop: anchorOffset});

            // Add the state to history as-per normal anchor links
            if(HISTORY_SUPPORT && pushToHistory) {
              history.pushState({}, document.title, location.pathname + href);
            }
          }

          return !!match;
        },

        /**
         * Attempt to scroll to the current location's hash.
         */
        scrollToCurrent: function(e) {
          if(this.scrollIfAnchor(window.location.hash) && e) {
            e.preventDefault();
          }
        },

        /**
         * If the click event's target was an anchor, fix the scroll position.
         */
        delegateAnchors: function(e) {
          var elem = e.target;

          if(this.scrollIfAnchor(elem.getAttribute('href'), true)) {
            e.preventDefault();
          }
        }
      };

      $(document).ready($.proxy(anchorScrolls, 'init'));
    })(window.document, window.history, window.location);

  </script>

  <div id="webchat">
  <script src="https://storage.googleapis.com/mrbot-cdn/webchat-0.4.1.js"></script>
  <script>
   WebChat.default.init({
       selector: "#webchat",
       initPayload: "/greet",
       socketUrl: "https://website-demo.rasa.com/",
       title: "",
       subtitle: "",
       profileAvatar: "https://rasa.com/assets/img/demo/rasa_avatar.png",
       showCloseButton: true,
       fullScreenMode: false,})
  </script>
  </div>
  </body>
</html>